# 08_힙

## 힙이란

### 우선순위 큐와 힙

- 우선순위가 있는 대상을 관리해야 하는 경우가 많이 있으며(e.g. CPU 스케줄링) 우선순위 큐를 정의하고 우선순위 큐를 구현하는 대표적인 자료구조로 힙이 있다. 

- 우선순위 큐의 추상 데이터 타입
  - 원소를 삽입한다
  - 최대 원소를 알려주면서 삭제한다
  - 최대 원소를 알려준다
  - 우선순위 큐가 비어 있는지 확인한다
  - 우선순위 큐를 깨끗이 비운다

### 힙과 완전 이진 트리

- 힙은 대표적인 우선순위 큐로, 완전 이진 트리라는 구조를 이용한다

- 트리는 노드들이 위에서 아래로 부모-자식 관계로 매달린 것을 말하며, 모든 노드가 2개 이하의 자식을 갖는 트리를 이진 트리(Binary Tree)라 한다. 
- 그 중에서 모든 자식 노드를 2개씩 가지는 트리를 완전 이진 트리(Complete Binary Tree)라고 한다.
- 완전 이진 트리이면서 모두 같은 레벨의 리프 노드를 갖는 트리를 포화 이진 트리(Full Binary Tree)라고 한다. 

### 힙의 조건

- 완전 이진 트리일 것
  - 배열을 이용하여 완전 이진 트리를 표현할 수 있다
  - 배열이 A[0] 부터 시작할 때 A[k] 의 자식은 A[2k+1]과 A[2k+2]가 된다.
  - A[k]의 부모 노드는 A[|(k-1)/2|]이다. 
- 힙 특성(Heap Property) : 모든 노드는 값을 갖고, 자식 노드들 값보다 크거나 같다. 

### 힙 객체의 구조

- A[] : 힙을 저장하는 배열
- numItems : 힙의 원소 수 저장
- insert(x) : 힙에 원소 x를 삽입한다
- deleteMax() : 힙의 최대 원소를 알려주면서 삭제한다
- buildHeap() : 배열 A[]를 힙으로 만든다
- max() : 힙의 최대 원소를 알려준다
- isEmpty() : 힙이 비었는지 알려준다
- clear() : 힙을 깨끗이 청소한다.



## 힙 작업 알고리즘과 구현

### 원소 삽입

- 힙 A[0, ... , n-1]에 새 원소가 들어오면 일단 맨 끝에 추가(A[n])한다.
- A[n]에 들어온 원소를 부모 노드 값보다 작거나 같을 때까지 재귀적으로 자신의 부모 노드와 바꿔나간다.

### 원소 삭제

- 우선순위 큐에서 삭제는 무조건 우선순위 값이 가장 큰 원소를 대상으로 한다. 
- A[0] 값을 삭제하고 맨 끝에 있는 원소를 A[0] 위치로 옮긴다.
- 루트 노드의 값을 자식 노드의 값과 비교하며 루트노드가 더 작을 경우 가장 큰 값을 가진 자식 노드와 바꾼다. 

### 힙 생성

- 빈 배열로부터 시작할 수도 있고, 임의의 배열을 힙으로 만든다음 사용할 수도 있다. 
- 리프 노드는 비교할 게 없으므로 마지막 리프 노드의 부모 노드부터 시작해서 루트 노드까지 순서대로 수선하게 된다. 
- 삭제와 마찬가지로 부모 노드가 가장 작지 않을 경우 자식 노드 중 큰 값과 바꾸어주는 것을 리프 노드까지 반복한다. 



## 힙 수행 시간

- 힙 작업들 중 가장 자주 하는 작업은 두 원소를 비교하는 일이며 이 일이 수행 시간을 결정한다. 
- 힙 크기가 n일 때, 
  - 힙 만들기에 Θ(n)의 시간이 든다(O(n log n) 이 아님)
  - 원소를 삽입할 때는 한 번 스며오르기를 하면 되므로 O(log n)의 시간이 든다 
  - 원소를 삭제할 때 O(log n)의 시간이 든다 